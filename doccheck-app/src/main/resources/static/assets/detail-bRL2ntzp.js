import{J as P,L as J,r as g,O as Q,P as X,s as $,d as r,e as u,n as K,N as R,u as ue,o as pe,g as t,f as e,w as l,D as W,c as h,q as A,I as _e,h as w,F as T,G as I,t as _,m as U,Q as he,S as ve,p as me,j as ge}from"./index-B4_lMgQc.js";import{c as fe}from"./demand-DGlRmvAG.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const we={__name:"echarts1",props:{ClassName:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"100%"},echartsData:{type:Array,default:()=>[]}},setup(f){const c=f;P(()=>c.echartsData,d=>{Object.keys(d).length>0&&J(()=>{O(),window.addEventListener("resize",V)})},{immediate:!0,deep:!0});const C=g(null),s=g(null),O=()=>{s.value||(s.value=Q(X(C.value,"light")));let d="0%";if(c.echartsData&&c.echartsData.length>=2){const m=c.echartsData[1].value||0,p=c.echartsData.reduce((k,S)=>k+(S.value||0),0);console.log(m,p),p>0&&(d=Math.round(m/p*100)+"%")}const v={tooltip:{show:!1},legend:{show:!1},series:[{name:"查重统计",type:"pie",radius:["40%","70%"],center:["50%","40%"],avoidLabelOverlap:!1,itemStyle:{color:function(m){const p=["#108b90","#ade0dd","#E6A23C","#9be881","#F56C6C"];return p[m.dataIndex%p.length]}},label:{show:!0,position:"center",formatter:()=>`
重复率
${d}
`,fontSize:14,fontWeight:"bold",color:"#333"},emphasis:{show:!1,scale:!1,scaleSize:10,itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},label:{show:!1,fontSize:16,fontWeight:"bold"}},labelLine:{show:!1},data:c.echartsData}]};s.value.setOption(v)},V=()=>{var d;(d=s.value)==null||d.resize()};return $(()=>{window.removeEventListener("resize",V)}),(d,v)=>(r(),u("div",{ref_key:"mainRef",ref:C,class:K(f.ClassName),style:R({height:f.height,width:f.width})},null,6))}},ye={__name:"echarts2",props:{ClassName:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"100%"},echartsData:{type:Array,default:()=>[]}},setup(f){const c=f;P(()=>c.echartsData,d=>{Object.keys(d).length>0&&J(()=>{O(),window.addEventListener("resize",V)})},{immediate:!0,deep:!0});const C=g(null),s=g(null),O=()=>{if(s.value||(s.value=Q(X(C.value,"light"))),c.echartsData&&c.echartsData.length>=2){const v=c.echartsData[0].value||0,m=c.echartsData.reduce((p,k)=>p+(k.value||0),0);console.log(v,m)}const d={tooltip:{show:!1},legend:{show:!0,right:"5%",top:"10%",orient:"vertical",icon:"circle",itemWidth:10,itemHeight:10,itemGap:20,formatter:function(v){let m="";for(let p=0;p<c.echartsData.length;p++)if(c.echartsData[p].name===v){m=c.echartsData[p].value;break}return`{name|${v}}  {value|${m}}`},textStyle:{rich:{name:{color:"#646464",fontSize:16},value:{color:"#079b79",fontSize:14,fontWeight:"bold"}}}},series:[{name:"查重统计",type:"pie",radius:["40%","70%"],center:["30%","40%"],avoidLabelOverlap:!1,itemStyle:{color:function(v){const m=["#108b90","#f8010c","#fcc522","#9eeb83"];return m[v.dataIndex%m.length]}},label:{show:!1},emphasis:{show:!1},labelLine:{show:!1},data:c.echartsData}]};s.value.setOption(d)},V=()=>{var d;(d=s.value)==null||d.resize()};return $(()=>{window.removeEventListener("resize",V)}),(d,v)=>(r(),u("div",{ref_key:"mainRef",ref:C,class:K(f.ClassName),style:R({height:f.height,width:f.width})},null,6))}},y=f=>(me("data-v-1858ac0d"),f=f(),ge(),f),Se={class:"main_page"},ke={key:0,class:"global-loading"},Ce={class:"loading-spinner"},De=y(()=>t("p",null,"数据加载中...",-1)),je={class:"table-header-container"},ze={class:"top"},Ve={class:"search-card-header"},Ne={class:"box-item"},xe=y(()=>t("div",{class:"overview-title"},"查重概况",-1)),Oe={key:0,class:"loading-container"},Fe=y(()=>t("div",{class:"loading-text"},"正在加载中...",-1)),Le=[Fe],Me={key:1,class:"echarts"},Te={class:"echarts-r",style:{"margin-top":"5px"}},Ie={style:{"font-size":"28px",color:"#13524d","font-weight":"900","font-family":"AlibabaPuHuiTiR"}},Re={class:"box-item",style:{flex:"1.3"}},Ye=y(()=>t("div",{class:"overview-title"},"专项重复情况",-1)),Ee={class:"detail-container"},He={class:"detail-rate"},Ae={class:"rate-value"},Ue={class:"detail-info"},$e={class:"info-name"},qe={class:"info-desc"},Ge={class:"box-item"},Be=y(()=>t("div",{class:"overview-title"},"典型问题类型",-1)),We={key:0,class:"loading-container"},Pe=y(()=>t("div",{class:"loading-text"},"正在加载中...",-1)),Je=[Pe],Qe={key:1,class:"echarts",style:{width:"100%"}},Xe={class:"box-item"},Ke=y(()=>t("div",{class:"overview-title"},"各单位重复情况",-1)),Ze={key:0,class:"loading-container"},et=y(()=>t("div",{class:"loading-text"},"正在加载中...",-1)),tt=[et],at={key:1,class:"progress"},lt={class:"progress-header"},ot={class:"progress-name"},st={class:"progress-rate"},nt={class:"progress-bar"},it={class:"table-container"},rt=["title"],ct={class:"info-row"},dt={class:"info-left"},ut={class:"table-item"},pt=y(()=>t("span",{style:{color:"#a4a4a4","font-weight":"bold"}},"项目关键信息：",-1)),_t={class:"truncate-text"},ht={class:"table-item"},vt=y(()=>t("span",{style:{color:"#a4a4a4","font-weight":"bold"}},"AI查重结果：",-1)),mt={class:"table-item"},gt=y(()=>t("span",{style:{color:"#a4a4a4","font-weight":"bold"}},"项目编码：",-1)),ft={class:"table-item"},bt=y(()=>t("span",{style:{color:"#a4a4a4","font-weight":"bold"}},"实施单位：",-1)),wt={class:"table-item"},yt=y(()=>t("span",{style:{color:"#a4a4a4","font-weight":"bold"}},"计划年份：",-1)),St={class:"info-right"},kt={style:{margin:"20px",height:"20px"}},Ct={__name:"detail",setup(f){const c=ue(),C=g(0),s=g({pageNo:1,pageSize:10,id:c.currentRoute.value.query.id}),O=i=>{H(),s.value.pageNo=i,v()},V=i=>{H(),s.value.pageSize=i,v()},d=g(0),v=()=>{k.value=!0,fe(s.value).then(i=>{if(i.data.code=="200"){const o=i.data.data;S.value[0]||(S.value[0]={value:0,name:"总项目数"}),S.value[1]||(S.value[1]={value:0,name:"重复项目数"}),S.value[0].value=o.totalGroupNum||0,S.value[1].value=o.duplicateGroupNum||0,q.value=o.specialItemConditionList||[],Y.value=Object.entries(o.duplicateMsgMap).map(([N,D])=>({name:N,value:D})),x.value=o.repositoryDocs,E.value=o.orgCondition||[],C.value=o.total||0,d.value=o.totalGroupNum||0}}).finally(()=>{k.value=!1})},m=g(0),p=()=>{const i=window.innerHeight,o=document.querySelector(".table-header-container"),N=o?o.offsetHeight:200,D=0;m.value=i-N-D-150};pe(()=>{p(),window.addEventListener("resize",p),v()}),$(()=>{window.removeEventListener("resize",p)});const k=g(!0),S=g([]),q=g([]),Y=g([]),E=g([]),n=g({projectName:"",projectCode:"",implOrg:"",planYear:"",projectMsg:"",duplicateStatus:"",duplicateFlg:""}),x=g([]),Z=i=>{x.value[i].showTable===void 0?x.value[i].showTable=!0:x.value[i].showTable=!x.value[i].showTable},ee=(i,o)=>i?i.length<=o?i:i.substring(0,o)+"...":"",H=()=>{n.value={projectName:"",projectCode:"",implOrg:"",planYear:"",projectMsg:"",duplicateStatus:""}},te=()=>{s.value.projectName=n.value.projectName,s.value.projectCode=n.value.projectCode,s.value.implOrg=n.value.implOrg,s.value.planYear=n.value.planYear?new Date(n.value.planYear).getFullYear().toString():"",s.value.projectMsg=n.value.projectMsg,s.value.duplicateStatus=n.value.duplicateStatus,s.value.duplicateFlg=n.value.duplicateFlg,s.value.pageNo=1,s.value.pageSize=10,v()},ae=i=>{console.log(i),c.push({path:"/comparison",query:{tableVal:i.id}})};return(i,o)=>{const N=h("el-icon"),D=h("el-breadcrumb-item"),le=h("el-breadcrumb"),L=h("el-input"),j=h("el-form-item"),F=h("el-option"),G=h("el-select"),oe=h("el-date-picker"),M=h("el-button"),se=h("el-form"),ne=h("el-tooltip"),z=h("el-table-column"),B=h("el-tag"),ie=h("el-table"),re=h("el-pagination"),ce=h("el-card");return r(),u("div",Se,[k.value?(r(),u("div",ke,[t("div",Ce,[e(N,{class:"is-loading"},{default:l(()=>[e(A(_e))]),_:1}),De])])):W("",!0),t("div",je,[e(le,{separator:"/"},{default:l(()=>[e(D,{to:{path:"/"}},{default:l(()=>[w("首页")]),_:1}),e(D,null,{default:l(()=>[w("需求查重管理")]),_:1}),e(D,null,{default:l(()=>[w("需求查重任务管理")]),_:1}),e(D,null,{default:l(()=>[w("详情")]),_:1})]),_:1})]),e(ce,{class:"search-card",style:R({height:m.value+"px"})},{default:l(()=>[t("div",ze,[t("div",Ve,[t("div",Ne,[xe,k.value||S.value.length===0?(r(),u("div",Oe,Le)):(r(),u("div",Me,[e(we,{echartsData:S.value,style:{width:"100%",height:"100%"}},null,8,["echartsData"])])),t("div",Te,[(r(!0),u(T,null,I(S.value,a=>(r(),u("div",{key:a.name,style:{"margin-bottom":"10px"}},[t("div",Ie,_(a.value),1),t("div",null,_(a.name),1)]))),128))])]),t("div",Re,[Ye,t("div",Ee,[(r(!0),u(T,null,I(q.value,a=>(r(),u("div",{key:a.name,class:"detail-item"},[t("div",He,[t("div",Ae,_(a.repeatRate),1)]),t("div",Ue,[t("div",$e,_(a.name),1),t("div",qe,"疑似重复对比组"+_(a.value)+"组",1)])]))),128))])]),t("div",Ge,[Be,k.value||Y.value.length===0?(r(),u("div",We,Je)):(r(),u("div",Qe,[e(ye,{echartsData:Y.value,style:{width:"100%",height:"100%"}},null,8,["echartsData"])]))]),t("div",Xe,[Ke,k.value||E.value.length===0?(r(),u("div",Ze,tt)):(r(),u("div",at,[(r(!0),u(T,null,I(E.value,a=>(r(),u("div",{key:a.name||a.impl_org,class:"progress-item"},[t("div",lt,[t("span",ot,_(a.impl_org)+_(a.invalid_ratio),1),t("span",st,_(a.invalid_ratio),1)]),t("div",nt,[t("div",{class:"progress-fill",style:R({width:a.invalid_ratio})},null,4)])]))),128))]))])]),e(se,{inline:!0,model:n.value,class:"demo-form-inline form-wrap"},{default:l(()=>[e(j,{label:"项目名称："},{default:l(()=>[e(L,{modelValue:n.value.projectName,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value.projectName=a),placeholder:"请输入项目名称",clearable:""},null,8,["modelValue"])]),_:1}),e(j,{label:"项目编码："},{default:l(()=>[e(L,{modelValue:n.value.projectCode,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value.projectCode=a),placeholder:"请输入项目编码",clearable:""},null,8,["modelValue"])]),_:1}),e(j,{label:"AI查重结果："},{default:l(()=>[e(G,{modelValue:n.value.duplicateFlg,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value.duplicateFlg=a),placeholder:"请选择查重状态"},{default:l(()=>[e(F,{label:"不重复",value:"0"}),e(F,{label:"重复",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(j,{label:"实施单位："},{default:l(()=>[e(L,{modelValue:n.value.implOrg,"onUpdate:modelValue":o[3]||(o[3]=a=>n.value.implOrg=a),placeholder:"请输入实施单位",clearable:""},null,8,["modelValue"])]),_:1}),e(j,{label:"计划年份："},{default:l(()=>[e(oe,{modelValue:n.value.planYear,"onUpdate:modelValue":o[4]||(o[4]=a=>n.value.planYear=a),type:"year",placeholder:"选择计划年份",clearable:""},null,8,["modelValue"])]),_:1}),e(j,{label:"项目信息："},{default:l(()=>[e(L,{modelValue:n.value.projectMsg,"onUpdate:modelValue":o[5]||(o[5]=a=>n.value.projectMsg=a),placeholder:"请输入项目信息",clearable:""},null,8,["modelValue"])]),_:1}),e(j,{label:"查重状态："},{default:l(()=>[e(G,{modelValue:n.value.duplicateStatus,"onUpdate:modelValue":o[6]||(o[6]=a=>n.value.duplicateStatus=a),placeholder:"请选择查重状态"},{default:l(()=>[e(F,{label:"等待中",value:"0"}),e(F,{label:"执行中",value:"1"}),e(F,{label:"已完成",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(j,{class:"buttonList"},{default:l(()=>[e(M,{onClick:H},{default:l(()=>[w("重置")]),_:1}),e(M,{type:"primary",onClick:te},{default:l(()=>[w("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),t("div",it,[(r(!0),u(T,null,I(x.value,(a,de)=>(r(),u("div",{class:"table-list",key:a.name},[t("div",{class:"table-name",title:a.name},_(a.projectName),9,rt),t("div",ct,[t("div",dt,[t("span",ut,[pt,e(ne,{content:a.projectMsg,placement:"top",effect:"dark"},{default:l(()=>[t("span",_t,_(ee(a.projectMsg,30)),1)]),_:2},1032,["content"])]),t("span",ht,[vt,w(_(a.duplicateFlg=="0"?"不重复":"重复"),1)]),t("span",mt,[gt,w(_(a.projectCode),1)]),t("span",ft,[bt,w(_(a.implOrg),1)]),t("span",wt,[yt,w(_(a.planYear),1)])]),t("div",St,[e(M,{type:"text",onClick:b=>Z(de)},{default:l(()=>[w(_(a.showTable?"收起":"展开")+" ",1),a.showTable?(r(),U(N,{key:0},{default:l(()=>[e(A(he))]),_:1})):(r(),U(N,{key:1},{default:l(()=>[e(A(ve))]),_:1}))]),_:2},1032,["onClick"])])]),a.showTable?(r(),U(ie,{key:0,data:a.groups,style:{width:"100%"},class:"bold-header-table"},{default:l(()=>[e(z,{prop:"projectCode",label:"项目编码"}),e(z,{prop:"projectName",label:"项目名称"}),e(z,{prop:"duplicateFlg",label:"AI查重结果"},{default:l(b=>[e(B,{type:b.row.duplicateFlg=="0"?"success":b.row.duplicateFlg=="1"?"danger":"info"},{default:l(()=>[w(_(b.row.duplicateFlg=="0"?"不重复":b.row.duplicateFlg=="1"?"重复":"未知"),1)]),_:2},1032,["type"])]),_:1}),e(z,{prop:"implOrg",label:"所属单位"}),e(z,{prop:"planYear",label:"计划年度"}),e(z,{prop:"projectMsg",label:"项目关键信息"}),e(z,{prop:"taskStatus",label:"项目工单状态"},{default:l(b=>[e(B,{type:b.row.taskStatus===0||b.row.taskStatus===1?"info":b.row.taskStatus===2?"success":"danger"},{default:l(()=>[w(_(b.row.taskStatus==0?"等待中":b.row.taskStatus==1?"执行中":b.row.taskStatus==2?"已完成":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(z,{label:"操作"},{default:l(b=>[e(M,{type:"primary",onClick:Dt=>ae(b.row),class:"gray-button"},{default:l(()=>[w("对比详情")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])):W("",!0)]))),128))]),t("div",kt,[e(re,{style:{float:"right"},background:"",layout:"prev, pager, next",total:C.value,"current-page":s.value.pageNo,"page-size":s.value.pageSize,onCurrentChange:O,onSizeChange:V},null,8,["total","current-page","page-size"])])]),_:1},8,["style"])])}}},Nt=be(Ct,[["__scopeId","data-v-1858ac0d"]]);export{Nt as default};
