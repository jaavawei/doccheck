var re=Object.defineProperty,ue=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var G=(c,i,s)=>i in c?re(c,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[i]=s,J=(c,i)=>{for(var s in i||(i={}))pe.call(i,s)&&G(c,s,i[s]);if($)for(var s of $(i))ce.call(i,s)&&G(c,s,i[s]);return c},P=(c,i)=>ue(c,de(i));var N=(c,i,s)=>new Promise((p,A)=>{var h=_=>{try{R(s.next(_))}catch(y){A(y)}},m=_=>{try{R(s.throw(_))}catch(y){A(y)}},R=_=>_.done?p(_.value):Promise.resolve(_.value).then(h,m);R((s=s.apply(c,i)).next())});import{j as me,k as ve,l as _e,m as ye,n as fe}from"./check-Cz-iBMhc.js";import{o as we,s as be,r as u,e as j,g as U,f as a,w as l,c as d,d as w,h as r,F as O,G as K,m as I,t as L,E as k,T as Q,v as ge}from"./index-B4_lMgQc.js";import{d as Re}from"./github-DJU-CCEv.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ne={class:"main_page"},ke={class:"table-header-container"},he={style:{margin:"20px",height:"20px"}},Te={class:"dialog-footer"},Ve={class:"markDownTable"},Ce=["innerHTML"],je={__name:"index",setup(c){we(()=>{s(),window.addEventListener("resize",s),y()}),be(()=>{window.removeEventListener("resize",s)});const i=u(0),s=()=>{const o=window.innerHeight,t=document.querySelector(".table-header-container"),V=t?t.offsetHeight:200,z=50;i.value=o-V-z-250},p=u({taskName:"",taskStatus:"",projectType:""}),A=()=>{p.value={taskName:"",taskStatus:"",projectType:""}},h=u([{speciality:"1",specialityName:"电网基建",TASK_SOURCE:"01",version_name:"新型电网基建"},{speciality:"2",specialityName:"电网小型基建",TASK_SOURCE:"02",version_name:"生产辅助基建"},{speciality:"3",specialityName:"电力市场营销",TASK_SOURCE:"03",version_name:"营销计量检测"},{speciality:"4",specialityName:"生产技改",TASK_SOURCE:"04",version_name:"生产设备技改"},{speciality:"6",specialityName:"生产大修",TASK_SOURCE:"04",version_name:"生产设备技改"},{speciality:"8",specialityName:"零星购置",TASK_SOURCE:"8",version_name:"固定资产零购"},{speciality:"09",specialityName:"研究开发",TASK_SOURCE:"09",version_name:"科研成本"},{speciality:"9",specialityName:"研究开发",TASK_SOURCE:"09",version_name:"科研能力建设"},{speciality:"10",specialityName:"电网数字化",TASK_SOURCE:"10",version_name:"数字化建设"},{speciality:"11",specialityName:"管理咨询",TASK_SOURCE:"",version_name:""},{speciality:"12",specialityName:"教育培训",TASK_SOURCE:"",version_name:""},{speciality:"13",specialityName:"股权投资",TASK_SOURCE:"13",version_name:"股权投资"},{speciality:"15",specialityName:"生产辅助技改",TASK_SOURCE:"15",version_name:"生产辅助技改"},{speciality:"16",specialityName:"生产辅助大修",TASK_SOURCE:"15",version_name:"生产辅助技改"}]),m=u({pageNo:1,pageSize:10,taskName:"",taskStatus:"",projectType:""}),R=u([]),_=u(0),y=()=>N(this,null,function*(){const o=yield me(m.value);o.data.code===200&&(R.value=o.data.data.result,_.value=o.data.data.total)}),H=()=>{m.value.taskName=p.value.taskName,m.value.taskStatus=p.value.taskStatus,m.value.projectType=p.value.projectType,y(),m.value.pageNo=1},W=o=>{m.value.pageNo=o,y()},X=o=>{m.value.pageSize=o,y()},T=u(!1),n=u({taskReviewName:"",repositoryReviewId:"",ruleReviewId:"",projectName:"",projectType:"",projectYear:""}),Y=u([]),B=u([]),Z=()=>N(this,null,function*(){const o=yield ve();if(o.data.code===200){if(o.data.data.ruleReviews.length===0)return k.warning("还没有配置审查规则，请配置后进行操作！"),Q.push("/examine1");if(Y.value=o.data.data.ruleReviews,o.data.data.repositoryReviews.length===0)return k.warning("还没有配置审查库，请配置后进行操作！"),Q.push("/examine");B.value=o.data.data.repositoryReviews}n.value={taskReviewName:"",repositoryReviewId:"",ruleReviewId:"",projectName:"",projectType:"",projectYear:""},T.value=!0}),D=()=>{T.value=!1,n.value={taskReviewName:"",repositoryReviewId:"",ruleReviewId:"",projectName:"",projectType:"",projectYear:""}},ee=()=>N(this,null,function*(){const o=P(J({},n.value),{projectYear:Number(n.value.projectYear)});delete o.ruleReviewId;const t=yield _e(o);console.log(t),t.data.code===200?(k({showClose:!0,message:"新建成功",type:"success"}),T.value=!1,y()):k({showClose:!0,message:t.data.data,type:"error"})}),ae=o=>{ge.alert("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>N(this,null,function*(){const t=yield ye(o.id);t.data.code===200?(k.success("删除成功"),y()):k.error(t.data.data)})).catch(()=>{console.log("取消删除")})},E=u(!1);u([]),u([]);const M=u(""),le=o=>N(this,null,function*(){E.value=!0;const t=yield fe(o.id);t.data.code===200&&(M.value=Re.parse(t.data.data.reviewResult))}),te=()=>{E.value=!1};return(o,t)=>{const V=d("el-breadcrumb-item"),z=d("el-breadcrumb"),x=d("el-input"),v=d("el-form-item"),b=d("el-option"),C=d("el-select"),g=d("el-button"),q=d("el-form"),f=d("el-table-column"),oe=d("el-tag"),se=d("el-table"),ie=d("el-pagination"),ne=d("el-card"),F=d("el-dialog");return w(),j("div",Ne,[U("div",ke,[a(z,{separator:"/"},{default:l(()=>[a(V,{to:{path:"/"}},{default:l(()=>[r("首页")]),_:1}),a(V,null,{default:l(()=>[r("验收审查管理")]),_:1}),a(V,null,{default:l(()=>[r("验收审查任务管理")]),_:1})]),_:1})]),a(ne,{class:"search-card"},{default:l(()=>[a(q,{inline:!0,model:p.value,class:"demo-form-inline"},{default:l(()=>[a(v,{label:"任务名称："},{default:l(()=>[a(x,{modelValue:p.value.taskName,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value.taskName=e),placeholder:"请输入任务名称",clearable:""},null,8,["modelValue"])]),_:1}),a(v,{label:"任务状态："},{default:l(()=>[a(C,{modelValue:p.value.taskStatus,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value.taskStatus=e),placeholder:"请选择任务状态"},{default:l(()=>[a(b,{label:"全部",value:"0"}),a(b,{label:"已完成",value:"1"}),a(b,{label:"执行中",value:"2"}),a(b,{label:"等待中",value:"3"})]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"项目名称："},{default:l(()=>[a(C,{modelValue:p.value.projectType,"onUpdate:modelValue":t[2]||(t[2]=e=>p.value.projectType=e),placeholder:"请选择项目类型"},{default:l(()=>[(w(!0),j(O,null,K(h.value,e=>(w(),I(b,{key:e.speciality,label:e.specialityName,value:e.speciality},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(v,{class:"buttonList"},{default:l(()=>[a(g,{onClick:A},{default:l(()=>[r("重置")]),_:1}),a(g,{type:"primary",onClick:H},{default:l(()=>[r("查询")]),_:1}),a(g,{type:"primary",onClick:H},{default:l(()=>[r("更新状态")]),_:1})]),_:1}),a(v,{style:{"margin-left":"auto"}},{default:l(()=>[a(g,{type:"primary",onClick:Z},{default:l(()=>[r("新建审查任务")]),_:1})]),_:1})]),_:1},8,["model"]),a(se,{data:R.value,style:{width:"100%"},height:i.value},{default:l(()=>[a(f,{label:"序号",width:"90"},{default:l(e=>[r(L(e.$index+1),1)]),_:1}),a(f,{prop:"taskReviewName",label:"审查任务名称"}),a(f,{prop:"repositoryReviewName",label:"审查库名称"}),a(f,{prop:"ruleReviewNames",label:"审查规则名称"},{default:l(e=>{var S;return[r(L((S=e.row.ruleReviewNames)==null?void 0:S.join(",")),1)]}),_:1}),a(f,{prop:"taskStatus",label:"任务状态"},{default:l(e=>[a(oe,{type:e.row.taskStatus===0||e.row.taskStatus===1?"info":e.row.taskStatus===2?"success":"danger"},{default:l(()=>[r(L(e.row.taskStatus==0?"等待中":e.row.taskStatus==1?"执行中":e.row.taskStatus==2?"已完成":"失败"),1)]),_:2},1032,["type"])]),_:1}),a(f,{prop:"projectName",label:"项目名称"}),a(f,{prop:"projectType",label:"项目类型"},{default:l(e=>[r(L(e.row.projectType?h.value.filter(S=>S.speciality==e.row.projectType)[0].specialityName:""),1)]),_:1}),a(f,{prop:"projectYear",label:"项目年份"}),a(f,{prop:"updatedAt",label:"操作时间",formatter:e=>o.$filters.formatTime(e.updatedAt)},null,8,["formatter"]),a(f,{label:"操作",fixed:"right","min-width":"120"},{default:l(e=>[a(g,{type:"primary",onClick:S=>le(e.row)},{default:l(()=>[r("详情")]),_:2},1032,["onClick"]),a(g,{type:"danger",onClick:S=>ae(e.row)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","height"]),U("div",he,[a(ie,{style:{float:"right"},background:"",layout:"prev, pager, next",total:_.value,"current-page":m.value.pageNo,"page-size":m.value.pageSize,onCurrentChange:W,onSizeChange:X},null,8,["total","current-page","page-size"])])]),_:1}),a(F,{modelValue:T.value,"onUpdate:modelValue":t[9]||(t[9]=e=>T.value=e),title:"新建审查任务",width:600,"before-close":D},{footer:l(()=>[U("div",Te,[a(g,{onClick:D},{default:l(()=>[r("取消")]),_:1}),a(g,{type:"primary",onClick:ee},{default:l(()=>[r("确定")]),_:1})])]),default:l(()=>[a(q,{model:n.value,"label-width":"auto",style:{margin:"20px auto"}},{default:l(()=>[a(v,{label:"审查任务名称"},{default:l(()=>[a(x,{modelValue:n.value.taskReviewName,"onUpdate:modelValue":t[3]||(t[3]=e=>n.value.taskReviewName=e)},null,8,["modelValue"])]),_:1}),a(v,{label:"审查库选择"},{default:l(()=>[a(C,{modelValue:n.value.repositoryReviewId,"onUpdate:modelValue":t[4]||(t[4]=e=>n.value.repositoryReviewId=e),placeholder:"请选择审查库"},{default:l(()=>[(w(!0),j(O,null,K(B.value,e=>(w(),I(b,{key:e.id,label:e.repositoryReviewName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"审查规则选择"},{default:l(()=>[a(C,{modelValue:n.value.ruleReviewIds,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value.ruleReviewIds=e),placeholder:"请选择审查规则",multiple:"","collapse-tags":""},{default:l(()=>[(w(!0),j(O,null,K(Y.value,e=>(w(),I(b,{key:e.id,label:e.ruleName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"项目名称"},{default:l(()=>[a(x,{modelValue:n.value.projectName,"onUpdate:modelValue":t[6]||(t[6]=e=>n.value.projectName=e)},null,8,["modelValue"])]),_:1}),a(v,{label:"项目类型"},{default:l(()=>[a(C,{modelValue:n.value.projectType,"onUpdate:modelValue":t[7]||(t[7]=e=>n.value.projectType=e),placeholder:"请选择项目类型"},{default:l(()=>[(w(!0),j(O,null,K(h.value,e=>(w(),I(b,{key:e.speciality,label:e.specialityName,value:e.speciality},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"项目年份"},{default:l(()=>[a(x,{modelValue:n.value.projectYear,"onUpdate:modelValue":t[8]||(t[8]=e=>n.value.projectYear=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(F,{modelValue:E.value,"onUpdate:modelValue":t[10]||(t[10]=e=>E.value=e),title:"审查任务详情",width:"800","before-close":te},{default:l(()=>[U("div",Ve,[U("div",{innerHTML:M.value},null,8,Ce)])]),_:1},8,["modelValue"])])}}},Ke=Se(je,[["__scopeId","data-v-718b8326"]]);export{Ke as default};
